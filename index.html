<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Report Center with Admin and Emoji Parser</title>
  <style>
    body {
      background-color: #1e1e2f;
      color: #f0f0f0;
      font-family: Arial, sans-serif;
      padding: 40px;
    }
    h1 {
      color: #66d9ef;
      display: flex;
      justify-content: space-between;
      align-items: center;
    }
    button {
      border: none;
      padding: 8px 12px;
      border-radius: 6px;
      font-weight: bold;
      cursor: pointer;
      margin-left: 8px;
    }
    .admin-btn {
      background: #ffaa00;
      color: #000;
    }
    .logout-btn {
      background: #ff4d4d;
      color: white;
    }
    .container {
      margin-top: 30px;
    }
    .category {
      background: #2a2a40;
      padding: 0;
      border-radius: 10px;
      margin-bottom: 25px;
      overflow: hidden;
    }
    .category-header {
      padding: 20px;
      cursor: pointer;
      background: #333;
      border-bottom: 1px solid #444;
      display: flex;
      justify-content: space-between;
      align-items: center;
    }
    .category h2 {
      margin: 0;
      color: #66d9ef;
    }
    .editable {
      background: #1e1e2f;
      border: none;
      padding: 20px;
      display: none;
      white-space: pre-wrap;
    }
    .editable[contenteditable="true"] {
      outline: 2px dashed #66d9ef;
      background: #1e1e3a;
    }
    .copy-btn {
      background: #66d9ef;
      color: #000;
    }
    .hidden {
      display: none;
    }
  </style>
</head>
<body>
  <h1>
    📋 Report Center
    <span>
      <button class="admin-btn" onclick="toggleEmoji()">😎 Emojis: <span id="emojiState">ON</span></button>
      <button class="admin-btn" onclick="requestAdmin()">🔐 Admin</button>
      <button class="logout-btn hidden" id="logoutBtn" onclick="logoutAdmin()">🚪 Logout</button>
    </span>
  </h1>

  <div id="container" class="container"></div>

  <script>
    const emojiMap = {
      ":jigsaw:": "🧩",
      ":gem:": "💎",
      ":athletic_shoe:": "👟",
      ":bar_chart:": "📊",
      ":arrows_counterclockwise:": "🔄",
      ":white_check_mark:": "✅",
      ":large_green_square:": "🟩",
      ":large_blue_square:": "🟦",
      ":warning:": "⚠️"
    };

    const categories = [
      "Problem Solve",
      "HRV Sort",
      "Shoes Sort",
      "IDRT",
      "FUD",
      "IOL",
      "Recon",
      "Damageland",
      "IB Dock PS"
    ];

    let isAdmin = localStorage.getItem("admin") === "true";
    let emojiOn = localStorage.getItem("emoji") !== "false";
    const storedReports = JSON.parse(localStorage.getItem("reports") || "{}");

    document.getElementById("emojiState").textContent = emojiOn ? "ON" : "OFF";
    if (isAdmin) document.getElementById("logoutBtn").classList.remove("hidden");

    function replaceShortcodes(text) {
      for (const [code, emoji] of Object.entries(emojiMap)) {
        text = text.split(code).join(emoji);
      }
      return text;
    }

    const container = document.getElementById("container");

    categories.forEach(cat => {
      const contentId = cat.replace(/\s+/g, "_");

      const section = document.createElement("div");
      section.className = "category";

      const header = document.createElement("div");
      header.className = "category-header";

      const h2 = document.createElement("h2");
      h2.textContent = cat;

      const btn = document.createElement("button");
      btn.className = "copy-btn";
      btn.textContent = "📋 Copy";

      header.appendChild(h2);
      header.appendChild(btn);
      section.appendChild(header);

      const text = document.createElement("div");
      text.className = "editable";
      text.id = contentId;
      text.contentEditable = isAdmin;
      let saved = storedReports[contentId] || `[Enter ${cat} Report Here]`;
      text.innerText = emojiOn ? replaceShortcodes(saved) : saved;
      section.appendChild(text);

      btn.onclick = () => {
        navigator.clipboard.writeText(text.innerText).then(() => alert("✅ Copied!"));
      };

      header.onclick = () => {
        const isVisible = text.style.display === "block";
        text.style.display = isVisible ? "none" : "block";
      };

      text.addEventListener("input", () => {
        if (!isAdmin) return;
        const updated = text.innerText;
        storedReports[contentId] = updated;
        localStorage.setItem("reports", JSON.stringify(storedReports));
      });

      container.appendChild(section);
    });

    function toggleEmoji() {
      emojiOn = !emojiOn;
      localStorage.setItem("emoji", emojiOn);
      document.getElementById("emojiState").textContent = emojiOn ? "ON" : "OFF";
      location.reload();
    }

    function requestAdmin() {
      const input = document.createElement("input");
      input.type = "password";
      input.placeholder = "Enter admin password";
      input.style.position = "fixed";
      input.style.top = "50%";
      input.style.left = "50%";
      input.style.transform = "translate(-50%, -50%)";
      input.style.padding = "10px";
      input.style.fontSize = "16px";
      input.style.zIndex = "1000";
      document.body.appendChild(input);
      input.focus();

      input.addEventListener("keydown", (e) => {
        if (e.key === "Enter") {
          if (input.value === "Qjuflore1211503") {
            localStorage.setItem("admin", "true");
            location.reload();
          } else {
            alert("❌ Incorrect password.");
          }
          document.body.removeChild(input);
        }
      });
    }

    function logoutAdmin() {
      localStorage.removeItem("admin");
      location.reload();
    }
  </script>
</body>
</html>
